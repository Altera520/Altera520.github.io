---
title: "KMP : 문자열 검색 알고리즘"
date: 2021-01-01T14:26:28+09:00
draft: true
categories:
    - Algorithm
tags:
    - KMP
    - Theory
---

## KMP

텍스트 내에서 특정 패턴을 검색하는데 사용하는 알고리즘이다.

텍스트 길이를 N, 패턴 길이를 M이라고 했을 때 단순 비교 문자열 매칭을 사용하면 $O(NM)$이 소요된다.       
KMP를 사용하면 **$O(N+M)$ 만으로 문자열 검색을 수행할 수 있다.**

<br/>

## 동작원리

### 수행방식
1. **패턴의 부분 문자열들을 가지고 테이블을 생성한다.**
    1. 패턴의 0~i 까지의 부분 문자열들 중 접두사와 접미사가 일치하는 
1. **문자열 검색을 수행한다.**
    1. 텍스트의 현재 위치에서 패턴 길이 만큼의 문자열이 일치하면 현재위치를 리스트에 추가한다.
    1. ㅇㅇ
    1. 2-1부터 반복한다.

<br/>

텍스트: ABCDABCDABEE        
패턴: ABCDABE

1. **패턴의 부분 문자열들을 가지고 테이블 생성**

{{% table "300" %}}
| i  | 부분 문자열 | table[i] |
|:--:|:-----------:|:--------:|
| 0  | A           | 0        |
| 1  | AB          | 0        |
| 2  | ABC         | 0        |
| 3  | ABCD        | 0        |
| 4  | <span class="md-r">A</span>BCD<span class="md-b">A</span>         | 1        |
| 5  | <span class="md-r">AB</span>CD<span class="md-b">AB</span>        | 2        |
| 6  | ABCDABE       | 0        |
{{% /table %}}

2. **문자열 검색 수행**

| 인덱스  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
|:-------:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:--:|:--:|
| 텍스트  | <span class="md-b md-l">A</span> | <span class="md-b md-l">B</span> | <span class="md-b">C</span> | <span class="md-b">D</span> | <span class="md-b md-l">A</span> | <span class="md-b md-l">B</span> | <span class="md-r">C</span> | D | A | B | E  | E  |
| 패턴    | <span class="md-b md-l">A</span> | <span class="md-b md-l">B</span> | <span class="md-b">C</span> | <span class="md-b">D</span> | <span class="md-b md-l">A</span> | <span class="md-b md-l">B</span> | <span class="md-r">E</span> |   |   |   |    |    |


- 접두사와 접미사가 일치한 부분에서 점프 수행
| 인덱스  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
|:-------:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:--:|:--:|
| 텍스트  | A | B | C | D | <span class="md-b">A</span> | <span class="md-b">B</span> | <span class="md-b">C</span> | <span class="md-b">D</span> | <span class="md-b">A</span> | <span class="md-b">B</span> | <span class="md-b">E</span>  | E  |
| 패턴    | | | | | <span class="md-b">A</span> | <span class="md-b">B</span> | <span class="md-b">C</span> | <span class="md-b">D</span> | <span class="md-b">A</span> | <span class="md-b">B</span> | <span class="md-b">E</span> |   |


<br/>

## Code
```cpp
#include <iostream> 
#include <string> 
#include <cstdio> 
#include <vector> 

using namespace std; 

vector<int> getPi(string p){ 
    int m = (int)p.size(), j=0; 
    vector<int> pi(m, 0); 

    for(int i = 1; i< m ; i++){ 
        while(j > 0 && p[i] != p[j]) j = pi[j-1]; 
        if(p[i] == p[j]) pi[i] = ++j; 
    } 
    return pi; 
} 

vector<int> kmp(string s, string p){ 
    vector<int> ans; 
    auto pi = getPi(p); 
    int n = (int)s.size(), m = (int)p.size(), j =0; 
    for(int i = 0 ; i < n ; i++){ 
        while(j>0 && s[i] != p[j]) j = pi[j-1]; 
        if(s[i] == p[j]){ 
            if(j==m-1){ 
                ans.push_back(i-m+1); 
                j = pi[j]; 
            }
            else{ 
                j++; 
            } 
        } 
    } 
    return ans; 
} 

int main(){ 
    string s, p; getline(cin, s); 
    getline(cin, p); 
    auto matched = kmp(s,p); 
    printf("%d\n", (int)matched.size()); 
    for(auto i : matched) printf("%d ", i+1); 
    return 0; 
}
```
</br>

## 참조
- [bowbowbow님의 블로그 - "KMP : 문자열 검색 알고리즘"](https://bowbowbow.tistory.com/6)