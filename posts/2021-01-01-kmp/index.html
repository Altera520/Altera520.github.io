<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>KMP : 문자열 검색 알고리즘 - Juneee blog</title><meta name=Description content><meta property="og:title" content="KMP : 문자열 검색 알고리즘"><meta property="og:description" content="KMP 정의 텍스트 내에서 특정 패턴을 검색하는데 사용하는 알고리즘이다.
 예시로 워드나 브라우저등에서 Ctrl + F 키를 눌러 단어를 찾는 기능에 적용 가능하다.  텍스트 길이를 n, 패턴 길이를 m이라고 했을 때 brute-force로 수행하면 텍스트의 각 인덱스마다 패턴 길이만큼 반복을하여 $O(nm)$이 소요된다.
KMP는 검색 효율을 높이기 위해 텍스트와 패턴의 구성 문자들을 비교해나가다가 불일치가 발생하면, 이전까지 일치했던 패턴의 부분 문자열내에서 접두사와 접미사가 일치한 길이로 패턴의 인덱스를 변경한 후 불일치한 부분과 다시 비교해나간다."><meta property="og:type" content="article"><meta property="og:url" content="https://altera520.github.io/posts/2021-01-01-kmp/"><meta property="article:published_time" content="2021-01-01T14:26:28+09:00"><meta property="article:modified_time" content="2021-01-01T14:26:28+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="KMP : 문자열 검색 알고리즘"><meta name=twitter:description content="KMP 정의 텍스트 내에서 특정 패턴을 검색하는데 사용하는 알고리즘이다.
 예시로 워드나 브라우저등에서 Ctrl + F 키를 눌러 단어를 찾는 기능에 적용 가능하다.  텍스트 길이를 n, 패턴 길이를 m이라고 했을 때 brute-force로 수행하면 텍스트의 각 인덱스마다 패턴 길이만큼 반복을하여 $O(nm)$이 소요된다.
KMP는 검색 효율을 높이기 위해 텍스트와 패턴의 구성 문자들을 비교해나가다가 불일치가 발생하면, 이전까지 일치했던 패턴의 부분 문자열내에서 접두사와 접미사가 일치한 길이로 패턴의 인덱스를 변경한 후 불일치한 부분과 다시 비교해나간다."><meta name=application-name content="Juneee blog"><meta name=apple-mobile-web-app-title content="Juneee blog"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://altera520.github.io/posts/2021-01-01-kmp/><link rel=prev href=https://altera520.github.io/posts/2020-12-31-back_tracking/><link rel=next href=https://altera520.github.io/posts/2021-01-06-singleton/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"KMP : 문자열 검색 알고리즘","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/altera520.github.io\/posts\/2021-01-01-kmp\/"},"genre":"posts","keywords":"KMP, Theory","wordcount":915,"url":"https:\/\/altera520.github.io\/posts\/2021-01-01-kmp\/","datePublished":"2021-01-01T14:26:28+09:00","dateModified":"2021-01-01T14:26:28+09:00","publisher":{"@type":"Organization","name":"altera520"},"author":{"@type":"Person","name":"altera520"},"description":""}</script></head><body header-desktop=auto header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('light'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'light'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><img src=/images/shiba.png class=img-profile alt=main width=35 height=35>
<a href=/ title="Juneee blog">Juneee blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><img src=/images/shiba.png class=img-profile alt=main width=35 height=35>
<a href=/ title="Juneee blog">Juneee blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+=' has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title><i class="fas fa-book"></i>index</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">KMP : 문자열 검색 알고리즘</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>altera520</a></span>&nbsp;<span class=post-category>included in <a href=/categories/algorithm/><i class="far fa-folder fa-fw"></i>Algorithm</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-01-01>2021-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;915 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span><i class="details-icon fas fa-angle-right"></i>index</span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#kmp-정의>KMP 정의</a></li><li><a href=#동작원리>동작원리</a><ul><li><a href=#수행방식>수행방식</a></li><li><a href=#brute-force-수행-예시>brute-force 수행 예시</a></li><li><a href=#kmp-수행-예시>KMP 수행 예시</a></li></ul></li><li><a href=#code>Code</a></li><li><a href=#references>References</a></li></ul></nav></div></div><div class=content id=content><h2 id=kmp-정의>KMP 정의</h2><p><strong>텍스트 내에서 특정 패턴을 검색하는데 사용하는 알고리즘이다.</strong></p><ul><li>예시로 워드나 브라우저등에서 Ctrl + F 키를 눌러 단어를 찾는 기능에 적용 가능하다.</li></ul><p>텍스트 길이를 n, 패턴 길이를 m이라고 했을 때<br>brute-force로 수행하면 텍스트의 각 인덱스마다 패턴 길이만큼 반복을하여 $O(nm)$이 소요된다.</p><p><strong>KMP는 검색 효율을 높이기 위해<br>텍스트와 패턴의 구성 문자들을 비교해나가다가 불일치가 발생하면,<br>이전까지 일치했던 패턴의 부분 문자열내에서 접두사와 접미사가 일치한 길이로 패턴의 인덱스를 변경한 후<br>불일치한 부분과 다시 비교해나간다.</strong></p><p>따라서, KMP를 사용하면 <strong>$O(n+m)$ 만으로 패턴 검색을 수행할 수 있다.</strong></p><br><h2 id=동작원리>동작원리</h2><h3 id=수행방식>수행방식</h3><ol><li><strong>패턴의 부분 문자열들을 가지고 접두사와 접미사가 일치하는 최대길이를 저장하는 테이블을 생성한다.</strong><ul><li>패턴의 0번째 인덱스부터 시작하여 길이가 1씩 증가하는 연속된 각 부분 문자열들의 접두사와 접미사가 일치하는 최대 길이를 구한다.<ul><li>{0, 1}, {0, 1, 2}, &mldr; , {0, 1, 2, &mldr;, m-1} <em>(m은 패턴의 사이즈)</em></li></ul></li></ul></li><li><strong>패턴 검색을 수행한다.</strong><ol><li>텍스트의 i번째 문자와 패턴의 j번째 문자를 비교한다.<ul><li>문자가 일치하지 않고 j의 인덱스가 1이상 이라면 점프한다. <em>(loop)</em><ul><li>j의 인덱스를 j-1번째 부분문자열의 접두사 접미사가 일치하는 최대길이로 변경한다.</li><li>해당 조건이 성립하지 않을때까지 반복한다.</li></ul></li><li>문자가 일치한다면<ul><li>j가 패턴의 마지막 인덱스라면 패턴을 찾았기에<br>다음 조회를 위해 j의 인덱스는 패턴의 접두사 접미사가 일치하는 최대길이로 변경한다.</li><li>j가 패턴의 마지막 인덱스가 아니라면 j의 인덱스를 1만큼 증가시킨다.</li></ul></li></ul></li><li>i의 인덱스를 1만큼 증가시킨다.</li><li>2-1부터 반복한다.</li></ol></li></ol><br><h3 id=brute-force-수행-예시>brute-force 수행 예시</h3><p>텍스트: ABCDABCDABEE<br>패턴: ABCDABE</p><ul><li><strong>문자열 매칭 수행</strong><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center></td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center></td></tr></tbody></table><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td></tr></tbody></table></li></ul><br><p>brute-force를 사용한 방식은 문자열의 매 인덱스마다 패턴 일치 여부를 조회하므로 $O(nm)$의 시간복잡도를 가진다.</p><p>문자열과 패턴의 길이가 짧다면 큰 문제는 없을 것이다. 하지만, 문자열과 패턴의 길이가 긴 경우에 이렇게 무식한 방법으로 조회를 수행하는 것은 많은 수행시간을 요구하므로 비효율적이다.</p><br><h3 id=kmp-수행-예시>KMP 수행 예시</h3><p>텍스트: ABCDABCDABEE<br>패턴: ABCDABE</p><ol><li><strong>패턴의 부분 문자열들을 가지고 테이블 생성</strong></li></ol><ol><table style=width:300px><thead><tr><th style=text-align:center>i</th><th style=text-align:center>부분 문자열</th><th style=text-align:center>table[i]</th></tr></thead><tbody><tr><td style=text-align:center>0</td><td style=text-align:center>A</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>1</td><td style=text-align:center>AB</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>2</td><td style=text-align:center>ABC</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>ABCD</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>4</td><td style=text-align:center><span class=md-r>A</span>BCD<span class=md-b>A</span></td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>5</td><td style=text-align:center><span class=md-r>AB</span>CD<span class=md-b>AB</span></td><td style=text-align:center>2</td></tr><tr><td style=text-align:center>6</td><td style=text-align:center>ABCDABE</td><td style=text-align:center>0</td></tr></tbody></table></ol><ol start=2><li><p><strong>문자열 매칭 수행</strong></p><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center><span class="md-b md-l">A</span></td><td style=text-align:center><span class="md-b md-l">B</span></td><td style=text-align:center><span class=md-b>C</span></td><td style=text-align:center><span class=md-b>D</span></td><td style=text-align:center><span class="md-b md-l">A</span></td><td style=text-align:center><span class="md-b md-l">B</span></td><td style=text-align:center><span class=md-r>C</span></td><td style=text-align:center>D</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>E</td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center><span class="md-b md-l">A</span></td><td style=text-align:center><span class="md-b md-l">B</span></td><td style=text-align:center><span class=md-b>C</span></td><td style=text-align:center><span class=md-b>D</span></td><td style=text-align:center><span class="md-b md-l">A</span></td><td style=text-align:center><span class="md-b md-l">B</span></td><td style=text-align:center><span class=md-r>E</span></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><p>$i=6$, $j=6$에서 문자가 불일치</p><table><thead><tr><th style=text-align:center>인덱스</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th><th style=text-align:center>8</th><th style=text-align:center>9</th><th style=text-align:center>10</th><th style=text-align:center>11</th></tr></thead><tbody><tr><td style=text-align:center>텍스트</td><td style=text-align:center>A</td><td style=text-align:center>B</td><td style=text-align:center>C</td><td style=text-align:center>D</td><td style=text-align:center><span class=md-b>A</span></td><td style=text-align:center><span class=md-b>B</span></td><td style=text-align:center><span class=md-b>C</span></td><td style=text-align:center><span class=md-b>D</span></td><td style=text-align:center><span class=md-b>A</span></td><td style=text-align:center><span class=md-b>B</span></td><td style=text-align:center><span class=md-b>E</span></td><td style=text-align:center>E</td></tr><tr><td style=text-align:center>패턴</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center><span class=md-b>A</span></td><td style=text-align:center><span class=md-b>B</span></td><td style=text-align:center><span class=md-b>C</span></td><td style=text-align:center><span class=md-b>D</span></td><td style=text-align:center><span class=md-b>A</span></td><td style=text-align:center><span class=md-b>B</span></td><td style=text-align:center><span class=md-b>E</span></td><td style=text-align:center></td></tr></tbody></table><p>텍스트의 인덱스인 i의 위치는 그대로 두고 패턴 인덱스인 j를 table[5]의 값으로 변경한다. (점프)</p><ul><li>$i=6$, $j=2$를 비교</li></ul></li></ol><br><p>따라서, 위의 예시를 통해 KMP를 사용하면 중복되는 정보(접두사와 접미사의 일치 정보)를 활용하여 $O(n+m)$만에 문자열 매칭을 수행할 수 있는 것을 확인가능하다.</p><br><h2 id=code>Code</h2><p><a href=https://www.acmicpc.net/problem/1786 target=_blank rel="noopener noreffer">백준 1786번 - 찾기</a>문제를 통해 검증된 코드를 첨부한다.<br>코드는 테이블을 생성하는 <code>init</code> 함수와 문자열 탐색을 수행하는 <code>kmp</code> 함수로 나뉜다.<br><code>init</code> 함수와 <code>kmp</code> 함수의 코드는 유사하며 코드는 아래와 같이 나뉜다.</p><ul><li><code>init</code> 함수<ul><li>패턴의 1번째 부터 m-1 까지 반복 <em>(m은 패턴의 사이즈)</em><ul><li>점프하는 부분</li><li>table의 i번째 값 설정하는 부분</li></ul></li></ul></li><li><code>kmp</code> 함수<ul><li>텍스트의 0번째 부터 n-1 까지 반복 <em>(n은 텍스트의 사이즈)</em><ul><li>점프하는 부분</li><li>텍스트의 i번째 문자와 패턴의 j번째 문자 일치여부를 검사하는 부분</li></ul></li></ul></li></ul><br><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=cp>#include</span> <span class=cpf>&lt;iostream&gt; </span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;string&gt; </span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;vector&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span> 

<span class=cm>/* 테이블 생성 O(m) */</span>
<span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>init</span><span class=p>(</span><span class=n>string</span> <span class=n>pattern</span><span class=p>)</span> <span class=p>{</span> 
    <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>pattern</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
    <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> 
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>table</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span> 

    <span class=c1>//pattern의 부분 문자열 별로 접두사 접미사 일치 최대길이 계산
</span><span class=c1></span>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span> <span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> 
        <span class=k>while</span><span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>pattern</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=n>pattern</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>      <span class=c1>// 점프
</span><span class=c1></span>            <span class=n>j</span> <span class=o>=</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span> 
        <span class=p>}</span>
        <span class=k>if</span><span class=p>(</span><span class=n>pattern</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>pattern</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>                  <span class=c1>// i번째 table 값 설정
</span><span class=c1></span>            <span class=n>j</span><span class=o>++</span><span class=p>;</span>
            <span class=n>table</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>j</span><span class=p>;</span> 
        <span class=p>}</span>
    <span class=p>}</span> 

    <span class=k>return</span> <span class=n>table</span><span class=p>;</span>
<span class=p>}</span> 

<span class=cm>/* 문자열 매칭 O(n+m) */</span>
<span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>kmp</span><span class=p>(</span><span class=n>string</span> <span class=n>str</span><span class=p>,</span> <span class=n>string</span> <span class=n>pattern</span><span class=p>)</span> <span class=p>{</span> 
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>ans</span><span class=p>;</span>                        <span class=c1>// 패턴이 일치한 위치를 담는 배열
</span><span class=c1></span>    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>table</span> <span class=o>=</span> <span class=n>init</span><span class=p>(</span><span class=n>pattern</span><span class=p>);</span>      <span class=c1>// 접두사 접미사 table 생성
</span><span class=c1></span>    <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>str</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
    <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>pattern</span><span class=p>.</span><span class=n>size</span><span class=p>();</span> 
    <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>

    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>){</span> 
        <span class=k>while</span><span class=p>(</span><span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>str</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=n>pattern</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>    <span class=c1>// 점프 수행
</span><span class=c1></span>            <span class=c1>// j의 인덱스를 j-1 번째 부분 문자열의 접두사 접미사 일치 길이로
</span><span class=c1></span>            <span class=n>j</span> <span class=o>=</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span>  
        <span class=p>}</span>
        <span class=k>if</span><span class=p>(</span><span class=n>str</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>pattern</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=p>{</span>  
            <span class=c1>// 문자열에서 패턴을 찾았다면 해당 패턴의 시작위치 추가
</span><span class=c1></span>            <span class=c1>// j의 인덱스를 j번째 부분 문자열의 접두사 접미사 일치 길이로
</span><span class=c1></span>            <span class=k>if</span><span class=p>(</span><span class=n>j</span> <span class=o>==</span> <span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>){</span>                 
                <span class=n>ans</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span> 
                <span class=n>j</span> <span class=o>=</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>];</span> 
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span> 
                <span class=n>j</span><span class=o>++</span><span class=p>;</span> <span class=c1>//문자만 일치한다면 j 증가
</span><span class=c1></span>            <span class=p>}</span> 
        <span class=p>}</span> 
    <span class=p>}</span>
    
    <span class=k>return</span> <span class=n>ans</span><span class=p>;</span> 
<span class=p>}</span> 

<span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span> 
    <span class=n>string</span> <span class=n>str</span><span class=p>,</span> <span class=n>pattern</span><span class=p>;</span> 
    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>matched</span><span class=p>;</span>

    <span class=n>getline</span><span class=p>(</span><span class=n>cin</span><span class=p>,</span> <span class=n>str</span><span class=p>);</span>
    <span class=n>getline</span><span class=p>(</span><span class=n>cin</span><span class=p>,</span> <span class=n>pattern</span><span class=p>);</span>

    <span class=n>matched</span> <span class=o>=</span> <span class=n>kmp</span><span class=p>(</span><span class=n>str</span><span class=p>,</span> <span class=n>pattern</span><span class=p>);</span> 

    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>matched</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=sc>&#39;\n&#39;</span><span class=p>;</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=nl>pos</span> <span class=p>:</span> <span class=n>matched</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>pos</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=sc>&#39; &#39;</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></br><h2 id=references>References</h2><ul><li><a href=https://bowbowbow.tistory.com/6 target=_blank rel="noopener noreffer">bowbowbow님의 블로그 - &ldquo;KMP : 문자열 검색 알고리즘&rdquo;</a></li><li><a href="https://m.blog.naver.com/PostView.nhn?blogId=ndb796&logNo=221240660061&proxyReferer=https:%2F%2Fwww.google.com%2F" target=_blank rel="noopener noreffer">안경잡이개발자님의 블로그 - KMP 알고리즘</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-01-01</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://altera520.github.io/posts/2021-01-01-kmp/ data-title="KMP : 문자열 검색 알고리즘" data-hashtags=KMP,Theory><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://altera520.github.io/posts/2021-01-01-kmp/ data-hashtag=KMP><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://altera520.github.io/posts/2021-01-01-kmp/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://altera520.github.io/posts/2021-01-01-kmp/ data-title="KMP : 문자열 검색 알고리즘"><i data-svg-src=/lib/simple-icons/icons/line.min.svg></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/kmp/>KMP</a>,&nbsp;<a href=/tags/theory/>Theory</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2020-12-31-back_tracking/ class=prev rel=prev title="백트래킹 (Back Tracking)">← </i>백트래킹 (Back Tracking)</a>
<a href=/posts/2021-01-06-singleton/ class=next rel=next title=싱글턴(Singleton)>싱글턴(Singleton) →</a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.75.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>altera520</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":500},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"title","label":"comment","lightTheme":"github-light","repo":"Altera520/blog-comment"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-0HZQPQBVVJ',{'anonymize_ip':true});</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-0HZQPQBVVJ" async></script></body></html>